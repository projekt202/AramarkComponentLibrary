<fieldset
  class="input"
  [ngClass]="{
    'input--disabled': isDisabled,
    'input--multiline': multiline,
    'input--size-small': size === 'small',
    'input--size-medium': size === 'medium',
    'input--search': type === 'search'
  }"
>
  <label [for]="name" *ngIf="label">
    <span class="input__label">
      <div class="input__label-main">
        <aus-typography
          [presetClassNames]="['text-preset-7--medium']"
          [text]="label"
        ></aus-typography>
        <div class="input__label-required-mark">
          <aus-typography
            [presetClassNames]="['text-preset-7--medium']"
            text="*"
            *ngIf="isRequired"
          ></aus-typography>
        </div>
      </div>
      <div *ngIf="subtitle" class="input__label-subtitle">
        <aus-typography
          [text]="subtitle"
          [presetClassNames]="['text-preset-7--medium']"
        ></aus-typography>
      </div>
    </span>
  </label>
  <div class="input__control-wrapper">
    <i class="input__control-icon" *ngIf="type === 'search'" aria-hidden="true">
      <svg
        width="18"
        height="18"
        viewBox="0 0 18 18"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M12.5 11H11.71L11.43 10.73C12.41 9.59 13 8.11 13 6.5C13 2.91 10.09 0 6.5 0C2.91 0 0 2.91 0 6.5C0 10.09 2.91 13 6.5 13C8.11 13 9.59 12.41 10.73 11.43L11 11.71V12.5L16 17.49L17.49 16L12.5 11ZM6.5 11C4.01 11 2 8.99 2 6.5C2 4.01 4.01 2 6.5 2C8.99 2 11 4.01 11 6.5C11 8.99 8.99 11 6.5 11Z"
          fill="black"
        />
      </svg>
    </i>
    <ng-container
      *ngTemplateOutlet="multiline ? textarea : input"
    ></ng-container>
    <button
      type="button"
      [attr.aria-label]="isValueVisible ? 'Hide content' : 'Show content'"
      *ngIf="visibilityToggle"
      (click)="toggleVisibility()"
      class="input__visibility-toggle"
    >
      <ng-container *ngIf="!isValueVisible; else eyeOff">
        <svg
          width="22"
          height="15"
          viewBox="0 0 22 15"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11 2C14.79 2 18.17 4.13 19.82 7.5C18.17 10.87 14.8 13 11 13C7.2 13 3.83 10.87 2.18 7.5C3.83 4.13 7.21 2 11 2ZM11 0C6 0 1.73 3.11 0 7.5C1.73 11.89 6 15 11 15C16 15 20.27 11.89 22 7.5C20.27 3.11 16 0 11 0ZM11 5C12.38 5 13.5 6.12 13.5 7.5C13.5 8.88 12.38 10 11 10C9.62 10 8.5 8.88 8.5 7.5C8.5 6.12 9.62 5 11 5ZM11 3C8.52 3 6.5 5.02 6.5 7.5C6.5 9.98 8.52 12 11 12C13.48 12 15.5 9.98 15.5 7.5C15.5 5.02 13.48 3 11 3Z"
            fill="black"
          />
        </svg>
      </ng-container>
      <ng-template #eyeOff>
        <svg
          width="22"
          height="20"
          viewBox="0 0 22 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11 3.55C14.79 3.55 18.17 5.68 19.82 9.05C19.23 10.27 18.4 11.32 17.41 12.17L18.82 13.58C20.21 12.35 21.31 10.81 22 9.05C20.27 4.66 16 1.55 11 1.55C9.73 1.55 8.51 1.75 7.36 2.12L9.01 3.77C9.66 3.64 10.32 3.55 11 3.55ZM9.93 4.69L12 6.76C12.57 7.01 13.03 7.47 13.28 8.04L15.35 10.11C15.43 9.77 15.49 9.41 15.49 9.04C15.5 6.56 13.48 4.55 11 4.55C10.63 4.55 10.28 4.6 9.93 4.69ZM1.01 1.42L3.69 4.1C2.06 5.38 0.77 7.08 0 9.05C1.73 13.44 6 16.55 11 16.55C12.52 16.55 13.98 16.26 15.32 15.73L18.74 19.15L20.15 17.74L2.42 0L1.01 1.42ZM8.51 8.92L11.12 11.53C11.08 11.54 11.04 11.55 11 11.55C9.62 11.55 8.5 10.43 8.5 9.05C8.5 9 8.51 8.97 8.51 8.92ZM5.11 5.52L6.86 7.27C6.63 7.82 6.5 8.42 6.5 9.05C6.5 11.53 8.52 13.55 11 13.55C11.63 13.55 12.23 13.42 12.77 13.19L13.75 14.17C12.87 14.41 11.95 14.55 11 14.55C7.21 14.55 3.83 12.42 2.18 9.05C2.88 7.62 3.9 6.44 5.11 5.52Z"
            fill="black"
          />
        </svg>
      </ng-template>
    </button>
    <div class="input__error" *ngIf="validationErrorMsg">
      <span class="input__error-icon">
        <ng-container *ngTemplateOutlet="iconStatusNegative"></ng-container>
      </span>
      <aus-typography [text]="validationErrorMsg"></aus-typography>
    </div>
    <div class="input__custom-status">
      <div class="input__custom-status-icon">
        <ng-container *ngIf="statusIcon === 'negative'">
          <ng-container *ngTemplateOutlet="iconStatusNegative"></ng-container>
        </ng-container>
        <ng-container *ngIf="statusIcon === 'positive'">
          <ng-container *ngTemplateOutlet="iconStatusPositive"></ng-container>
        </ng-container>
      </div>
      <div class="input__custom-status-content">
        <ng-content select="[statusMsg]"></ng-content>
      </div>
    </div>
  </div>
</fieldset>

<ng-template #iconStatusNegative>
  <svg
    width="14"
    height="14"
    viewBox="0 0 14 14"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M6.33333 9.00001H7.66666V10.3333H6.33333V9.00001ZM6.33333 3.66668H7.66666V7.66668H6.33333V3.66668ZM6.99333 0.333344C3.31333 0.333344 0.333328 3.32001 0.333328 7.00001C0.333328 10.68 3.31333 13.6667 6.99333 13.6667C10.68 13.6667 13.6667 10.68 13.6667 7.00001C13.6667 3.32001 10.68 0.333344 6.99333 0.333344ZM7 12.3333C4.05333 12.3333 1.66666 9.94668 1.66666 7.00001C1.66666 4.05334 4.05333 1.66668 7 1.66668C9.94666 1.66668 12.3333 4.05334 12.3333 7.00001C12.3333 9.94668 9.94666 12.3333 7 12.3333Z"
      fill="#EB002A"
    />
  </svg>
</ng-template>

<ng-template #iconStatusPositive>
  <svg
    width="14"
    height="14"
    viewBox="0 0 14 14"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M13.6666 2.45334L6.05998 10.0667L3.23331 7.24001L4.17331 6.30001L6.05998 8.18668L12.7266 1.52001L13.6666 2.45334ZM12.1933 5.81334C12.28 6.19334 12.3333 6.59334 12.3333 7.00001C12.3333 9.94668 9.94665 12.3333 6.99998 12.3333C4.05331 12.3333 1.66665 9.94668 1.66665 7.00001C1.66665 4.05334 4.05331 1.66668 6.99998 1.66668C8.05331 1.66668 9.02665 1.97334 9.85331 2.50001L10.8133 1.54001C9.73331 0.78001 8.41998 0.333344 6.99998 0.333344C3.31998 0.333344 0.333313 3.32001 0.333313 7.00001C0.333313 10.68 3.31998 13.6667 6.99998 13.6667C10.68 13.6667 13.6666 10.68 13.6666 7.00001C13.6666 6.20668 13.52 5.44668 13.2666 4.74001L12.1933 5.81334Z"
      fill="#128816"
    />
  </svg>
</ng-template>

<ng-template #input>
  <input
    [id]="name"
    [name]="name"
    [type]="type"
    [(ngModel)]="value"
    [disabled]="!!isDisabled"
    [pattern]="pattern || '.*'"
    [required]="isRequired ?? false"
    [maxLength]="maxLength ?? 10000"
    [minLength]="minLength ?? 0"
    [placeholder]="placeholder || ''"
    (ngModelChange)="valueChange.emit(value)"
    (keypress)="onKeypress($event)"
    class="input__control"
    #control="ngModel"
    autocomplete="off"
    [mask]="mask || null"
  />
</ng-template>

<ng-template #textarea>
  <textarea
    [id]="name"
    [name]="name"
    [(ngModel)]="value"
    [disabled]="!!isDisabled"
    [required]="isRequired ?? false"
    [maxLength]="maxLength ?? 10000"
    [placeholder]="placeholder || ''"
    (ngModelChange)="valueChange.emit(value)"
    class="input__control input__control--textarea"
    #control="ngModel"
    autocomplete="off"
  >
  </textarea>
</ng-template>
